From f0a2e4226028c4a68d956ef9ac1d4d43fdbe961e Mon Sep 17 00:00:00 2001
From: Mikolaj Izdebski <mizdebsk@redhat.com>
Date: Thu, 20 Nov 2014 16:22:52 +0100
Subject: [PATCH 5/6] Improve patterns for matching OSGi manifests

---
 depgenerators/fileattrs/osgi.attr  | 2 +-
 python/javapackages/common/osgi.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/depgenerators/fileattrs/osgi.attr b/depgenerators/fileattrs/osgi.attr
index f65cb0a..edacd4d 100644
--- a/depgenerators/fileattrs/osgi.attr
+++ b/depgenerators/fileattrs/osgi.attr
@@ -2,4 +2,4 @@
 %__osgi_provides_opts	%{_builddir}/%{?buildsubdir}
 %__osgi_requires	%{_rpmconfigdir}/osgi.req
 %__osgi_requires_opts	%{_builddir}/%{?buildsubdir}
-%__osgi_path	^(.*\\.jar$|((%{_prefix}/lib|%{_datadir})/.*/MANIFEST.MF))
+%__osgi_path	^(.*\\.jar|((%{_prefix}/lib|%{_datadir})/.*/META-INF/MANIFEST.MF))$
diff --git a/python/javapackages/common/osgi.py b/python/javapackages/common/osgi.py
index a1d72fc..66610c2 100644
--- a/python/javapackages/common/osgi.py
+++ b/python/javapackages/common/osgi.py
@@ -93,7 +93,7 @@ def split_bundle_name(bundles):
 
 def open_manifest(path):
     mf = None
-    if path.endswith("META-INF/MANIFEST.MF"):
+    if path.endswith("/META-INF/MANIFEST.MF"):
         mf = open(path, "rb")
     if zipfile.is_zipfile(path):
         # looks like "zipfile.is_zipfile()" is not reliable
-- 
1.9.3

